<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Notes and meditations">
        <meta name="viewport" content="width=device-width">
        <title>Home &mdash; Wachunga</title>
            <link rel="stylesheet" href="_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="_static/main.css" type="text/css">
            <link rel="stylesheet" href="_static/flat.css" type="text/css">
            <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="_static/webfont.css" type="text/css">
        <link rel="shortcut icon" href="_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="_static/plugins.js"></script>
        <script src="_static/main.js"></script>
        <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="_static/underscore.js"></script><script type="text/javascript" src="_static/doctools.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script></head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header>
            <hgroup>
              <h1><a href="#">Wachunga</a></h1><h2>Notes and ramblings on hacking and finance</h2></hgroup>
          </header>
      <nav>
            <ul><li class="main-nav">
                  <a href="#">Home</a>
                </li>
              <li class="main-nav">
                  <a href="pages/about.html">About</a>
                </li>
              </ul>
          </nav><div class="main-container"><div class="main wrapper clearfix"><article><div class="timestamp postmeta">
            <span>January 13, 2014</span>
        </div>
        <div class="section" id="remember-vim-folding">
<h1><a href="2014/01/13/remember_vim_folding.html">Remember Vim folding</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="11%"/>
<col width="89%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head">Operation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>zO</td>
<td>Open all folds recursivley</td>
</tr>
<tr class="row-odd"><td>zo</td>
<td>Open one fold</td>
</tr>
<tr class="row-even"><td>zc</td>
<td>Close one fold</td>
</tr>
<tr class="row-odd"><td>zC</td>
<td>Close all folds recursivley</td>
</tr>
<tr class="row-even"><td>za</td>
<td>Toggle fold</td>
</tr>
<tr class="row-odd"><td>zA</td>
<td>Toggle fold recursivley</td>
</tr>
<tr class="row-even"><td>zR</td>
<td>Open all folds</td>
</tr>
<tr class="row-odd"><td>zM</td>
<td>Close all folds</td>
</tr>
</tbody>
</table>
<p>Then i set the following in .vimrc:</p>
<div class="highlight-python"><pre>&quot; folding
&quot; toggle open fold
nnoremap f zA
&quot; open all
nnoremap F zR
&quot; clos all
nnoremap &lt;C-f&gt; zM</pre>
</div>
</div>
        <div class="postmeta">
        <div class="author">
            <span>Posted by Chris Morgan</span>
        </div>
        
        
        </div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>January 05, 2014</span>
        </div>
        <div class="section" id="being-even-more-productive-with-ipython-notebooks">
<h1><a href="2014/01/05/being_productive_with_ipython_notebooks.html">Being even more productive with IPython notebooks</a></h1>
<p>IPython notebooks are an awesome tool for exploring data. Currently there are a
few issues with the software which the community are working through.</p>
<div class="section" id="slides">
<h2>Slides</h2>
<p>Particularly useful is the ability to be able to create slides from your
notebooks using reveal.js:</p>
<div class="highlight-bash"><div class="highlight"><pre>python3 nbconvert --to slides BeigeBook.ipynb --post serve
</pre></div>
</div>
<p>But we need to follow these steps in order for the formatting to work
correctly:</p>
<ol class="arabic simple">
<li>Add this custom.css file: <a class="reference external" href="https://gist.github.com/damianavila/6211198">https://gist.github.com/damianavila/6211198</a></li>
<li>Run this little snippet: <a class="reference external" href="https://gist.github.com/damianavila/6211211">https://gist.github.com/damianavila/6211211</a></li>
<li>Add ?print.pdf to the end of the url</li>
<li>Print to pdf, use Landscape orientation</li>
</ol>
</div>
<div class="section" id="git">
<h2>Git</h2>
<p>The JSON format of IPython notebooks is create, however there is no need to save Base64 encoded binary data in Git. We can strip out the binary blobs with Git filters.  Add the following somewhere on your path: <a class="reference external" href="https://github.com/cfriedline/ipynb_template/blob/master/nbstripout">https://github.com/cfriedline/ipynb_template/blob/master/nbstripout</a>, then add the following in <span class="docutils literal"><span class="pre">.git/config</span></span>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>filter <span class="s2">&quot;stripoutput&quot;</span><span class="o">]</span>
    <span class="nv">clean</span> <span class="o">=</span> <span class="s2">&quot;/path/to/nbstripout&quot;</span>
</pre></div>
</div>
<p>And a <span class="docutils literal"><span class="pre">.gitattributes</span></span> file in your project root with the following contents:</p>
<div class="highlight-bash"><div class="highlight"><pre>*.ipynb <span class="nv">filter</span><span class="o">=</span>stripoutput
</pre></div>
</div>
<p>You will not notice any changes to your local <span class="docutils literal"><span class="pre">.ipynb</span></span> file when you commit (as the content is being filtered, not replaced as a pre-commit hook would do). Once committed, delete the file and checkout again and you will see a <span class="docutils literal"><span class="pre">.ipynb</span></span> file sans output. Also the numbering of cells will start continuously from 1 - great!</p>
</div>
</div>
        <div class="postmeta">
        <div class="author">
            <span>Posted by Chris Morgan</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/tools.html">tools</a>, <a href="tags/python.html">python</a></span>
        </div>
        </div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>January 03, 2014</span>
        </div>
        <div class="section" id="setting-up-matlab-contexts">
<h1><a href="2014/01/03/setup_matlab.html">Setting up MATLAB contexts</a></h1>
<p>If you are forced to use MATLAB (here’s a whole blog devoted to the topic of
why not to use it <a class="reference external" href="http://abandonmatlab.wordpress.com">http://abandonmatlab.wordpress.com/</a>) the following advice
maybe useful for easily managing your path and hence creating contexts of work.</p>
<p>In cases where Administrator privileges are not held, the following config. is
flexible.</p>
<p>Define MATLAB’s <span class="docutils literal"><span class="pre">userpath</span></span> to be a user writeable directory. This is the initial
directory MATLAB will parse.</p>
<p>Within the <span class="docutils literal"><span class="pre">userpath</span></span> create <span class="docutils literal"><span class="pre">startup.m</span></span>:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span class="k">if</span> <span class="o">~</span><span class="n">isdeployed</span>
    <span class="n">path</span><span class="p">(</span><span class="n">my_path</span><span class="p">)</span>
    <span class="n">set_vars</span>
</pre></div>
</div>
<p>Where <span class="docutils literal"><span class="pre">my_path</span></span> is a matlab file which sets the path like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">function</span> <span class="n">p</span> <span class="o">=</span> <span class="n">my_path</span>
     <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="s">'/home/chris/matlab;'</span><span class="p">,</span> <span class="s">'/home/chris/important;'</span><span class="p">];</span>
     <span class="n">cd</span><span class="p">(</span><span class="s">'/home/chris/matlab'</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>
</div>
<p>So we set the path and cd to a relevant directory. Also in the userpath folder,
one can keep many files like <span class="docutils literal"><span class="pre">my_path.m</span></span>, which define different contexts to
work in, making changing contexts as easy as:</p>
<div class="highlight-matlab"><div class="highlight"><pre><span class="n">path</span><span class="p">(</span><span class="n">my_other_path</span><span class="p">)</span>
</pre></div>
</div>
<p>Whithin each context <span class="docutils literal"><span class="pre">path</span></span> file if you also call the <span class="docutils literal"><span class="pre">set_vars</span></span> script,
this allows <span class="docutils literal"><span class="pre">set_vars</span></span> to contain useful variables e.g. paths to output
directories and the like.</p>
</div>
        <div class="postmeta">
        <div class="author">
            <span>Posted by Chris Morgan</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/matlab.html">matlab</a>, <a href="tags/tools.html">tools</a></span>
        </div>
        </div><div class="separator post_separator"></div><div class="timestamp postmeta">
            <span>May 01, 2013</span>
        </div>
        <div class="section" id="common-operations-in-pandas">
<h1><a href="2013/05/01/common_operations_in_pandas.html">Common operations in Pandas</a></h1>
<p>If you munge data in Python then you really should be using <a class="reference external" href="http://pandas.pydata.org">Pandas</a>. These are some notes about common operations.</p>
<div class="section" id="hierachical-index">
<h2>Hierachical index</h2>
<p>Given a set of data like this (refered to as Table A):</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="36%"/>
<col width="16%"/>
<col width="16%"/>
<col width="16%"/>
<col width="17%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"> </th>
<th class="head">Bid</th>
<th class="head">Mid</th>
<th class="head">Offer</th>
<th class="head">Variable</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1994-01-03 16:00:00</td>
<td>0.9980</td>
<td>0.9981</td>
<td>0.9981</td>
<td>ARS</td>
</tr>
<tr class="row-odd"><td>1994-01-03 16:00:00</td>
<td>12.2190</td>
<td>12.2215</td>
<td>12.2240</td>
<td>ATS</td>
</tr>
<tr class="row-even"><td>1994-01-03 16:00:00</td>
<td>0.6835</td>
<td>0.6838</td>
<td>0.6840</td>
<td>AUD</td>
</tr>
<tr class="row-odd"><td>1994-01-03 16:00:00</td>
<td>39.0000</td>
<td>39.0000</td>
<td>39.0000</td>
<td>BDT</td>
</tr>
<tr class="row-even"><td>1994-01-03 16:00:00</td>
<td>36.2060</td>
<td>36.2425</td>
<td>36.2790</td>
<td>BEF</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It often makes more sense to represent it as a hierachical index (referred to as Table B), e.g.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="36%"/>
<col width="17%"/>
<col width="16%"/>
<col width="16%"/>
<col width="16%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"> </th>
<th class="head"> </th>
<th class="head">Bid</th>
<th class="head">Mid</th>
<th class="head">Offer</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>index</td>
<td>Variable</td>
<td> </td>
<td> </td>
<td> </td>
</tr>
<tr class="row-odd"><td>1994-01-03 16:00:00</td>
<td>ARS</td>
<td>0.9980</td>
<td>0.9981</td>
<td>0.9981</td>
</tr>
<tr class="row-even"><td> </td>
<td>ATS</td>
<td>12.2190</td>
<td>12.2215</td>
<td>12.2240</td>
</tr>
<tr class="row-odd"><td> </td>
<td>AUD</td>
<td>0.6835</td>
<td>0.6838</td>
<td>0.6840</td>
</tr>
<tr class="row-even"><td> </td>
<td>BDT</td>
<td>39.0000</td>
<td>39.0000</td>
<td>39.0000</td>
</tr>
<tr class="row-odd"><td> </td>
<td>BEF</td>
<td>36.2060</td>
<td>36.2425</td>
<td>36.2790</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This can be done for a pandas.DataFrame <span class="docutils literal"><span class="pre">df</span></span> like so</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'index'</span><span class="p">,</span> <span class="s">'Variable'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="subset-of-columns-and-a-pivot">
<h2>Subset of columns and a pivot</h2>
<p>Consider again Table A above loaded as <span class="docutils literal"><span class="pre">df</span></span>, if we wish to filter out a
subset of values in the <span class="docutils literal"><span class="pre">Variable</span></span> column, and consider the <span class="docutils literal"><span class="pre">Mid</span></span> values
only for then we can do the following to have a continuous time series:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">g10_set</span> <span class="o">=</span> <span class="p">[</span>
<span class="s">'USD'</span><span class="p">,</span> <span class="s">'EUR'</span><span class="p">,</span> <span class="s">'JPY'</span><span class="p">,</span> <span class="s">'CHF'</span><span class="p">,</span> <span class="s">'GBP'</span><span class="p">,</span> <span class="s">'AUD'</span><span class="p">,</span> <span class="s">'CAD'</span><span class="p">,</span> <span class="s">'SEK'</span><span class="p">,</span>
<span class="s">'NOK'</span><span class="p">,</span> <span class="s">'NZD'</span>
<span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'Variable'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">g10_set</span><span class="p">)]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="s">'index'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'Variable'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'Mid'</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Which results in Table C:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="26%"/>
<col width="10%"/>
<col width="10%"/>
<col width="10%"/>
<col width="6%"/>
<col width="10%"/>
<col width="11%"/>
<col width="10%"/>
<col width="7%"/>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">AUD</th>
<th class="head">CAD</th>
<th class="head">CHF</th>
<th class="head">EUR</th>
<th class="head">GBP</th>
<th class="head">JPY</th>
<th class="head">NOK</th>
<th class="head"> </th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>index</td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
<td> </td>
</tr>
<tr class="row-odd"><td>1994-01-03 16:00:00</td>
<td>0.6838</td>
<td>1.3143</td>
<td>1.4827</td>
<td>NaN</td>
<td>1.4805</td>
<td>112.395</td>
<td>7.5251</td>
<td> </td>
</tr>
<tr class="row-even"><td>1994-01-04 16:00:00</td>
<td>0.6848</td>
<td>1.3164</td>
<td>1.4861</td>
<td>NaN</td>
<td>1.4819</td>
<td>113.155</td>
<td>7.5259</td>
<td> </td>
</tr>
<tr class="row-odd"><td>1994-01-05 16:00:00</td>
<td>0.6873</td>
<td>1.3153</td>
<td>1.4800</td>
<td>NaN</td>
<td>1.4864</td>
<td>112.760</td>
<td>7.5020</td>
<td> </td>
</tr>
<tr class="row-even"><td>1994-01-06 16:00:00</td>
<td>0.6843</td>
<td>1.3220</td>
<td>1.4745</td>
<td>NaN</td>
<td>1.4880</td>
<td>112.555</td>
<td>7.4903</td>
<td> </td>
</tr>
<tr class="row-odd"><td>1994-01-07 16:00:00</td>
<td>0.6868</td>
<td>1.3225</td>
<td>1.4705</td>
<td>NaN</td>
<td>1.4905</td>
<td>111.825</td>
<td>7.4865</td>
<td> </td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="other-bits-and-bobs">
<h2>Other bits and bobs</h2>
<ul class="simple">
<li>Find row where value of column is max: <span class="docutils literal"><span class="pre">df['AUD'].argmax()</span></span></li>
<li>Find indexes of null values <span class="docutils literal"><span class="pre">pd.isnull(df).any(1).nonzero()</span></span> which is
utilising the <span class="docutils literal"><span class="pre">nonzero</span></span> numpy object, i.e. return indicies of elements
which are nonzero.</li>
</ul>
</div>
</div>
        <div class="postmeta">
        <div class="author">
            <span>Posted by Chris Morgan</span>
        </div>
        
        <div class="tags">
            <span>
                Tags:
                <a href="tags/python.html">python</a>, <a href="tags/tools.html">tools</a></span>
        </div>
        </div><div class="archive_link">
        <a href="archive.html"> &mdash; Blog Archive &mdash; </a>
    </div></article><aside class="sidebar"><section><div class="widget">
    <h1>Recent Posts</h1>
    <ul><li>
            <a href="2014/01/13/remember_vim_folding.html">Remember Vim folding</a>
        </li><li>
            <a href="2014/01/05/being_productive_with_ipython_notebooks.html">Being even more productive with IPython notebooks</a>
        </li><li>
            <a href="2014/01/03/setup_matlab.html">Setting up MATLAB contexts</a>
        </li><li>
            <a href="2013/05/01/common_operations_in_pandas.html">Common operations in Pandas</a>
        </li></ul>
</div>
</section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container"><footer class="wrapper">&copy; Copyright 2013, Chris Morgan. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- footer-container -->

      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>